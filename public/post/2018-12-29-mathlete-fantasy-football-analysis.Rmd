---
title: Mathlete Fantasy Football Analysis
author: Dusty Turner
date: '2018-12-29'
slug: mathlete-fantasy-football-analysis2018
categories:
  - army math
  - beatnavy
  - ESPN API
  - YAHOO API
tags:
  - army math
  - beatnavy
  - ESPN API
  - YAHOO API
output:
  blogdown::html_page:
    toc: TRUE
    # theme: lumen
    # highlight: tango
---

## Introduction

In my previous [post](https://dusty-turner.netlify.com/post/espn-yahoo-api-navigation/), I worked through how to get your league information from the ESPN and YAHOO APIs.  

The motivation for this project was to compare two leagues performances over the 2018 fantasy football season.  As the ring leader of the West Point Department of Mathematical Sciences fantasy football league, we had 20 managers.  This, of course, is too many for one league so we split the teams across two leagues.  I managed an ESPN league, and a colleague managed a yahoo league.  

This post will pick up where last post left off and do some analysis between the two leagues.

### Libraries

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(DT)
```

## The Data

Let me read in the saved data from both leagues, join them together, and display it in an interactive format.

```{r message=FALSE, warning=FALSE}
ffdata = read_csv("espndf.csv") %>%
  rbind(
    read_csv("yahoodf.csv"))
ffdata %>% datatable()
```

## Awards

Every week, we hand out prizes for the highest overall point total and lowest.  

### Highest Weekly Point Total

The prizes for the highest points across both leagues is the honor of posessing the "Mug of my Mug" for the week.  Yes, as you can see below, it is a mug with a picture of my face.  The extra great thing about this mug, as you may be able to see, is I took it concussed with a fractured face.  I earned my concussion and facial fracture in a softball colision.  Yes, I was called out...

```{r echo=FALSE, fig.width=1}
knitr::include_graphics("/mug.JPG")
```

So who are the weekly highest scorers?  Lets build the dataframe to determine this.

The dataframe below determines who wins each game each week.

```{r}
gamewinnerdf = ffdata %>%
  group_by(week) %>%
  mutate(Winner = ifelse(TeamA>TeamB,PointsA,PointsB)) %>%
  mutate(Loser = ifelse(TeamA>TeamB,PointsB,PointsA)) %>%
  mutate(Delta = pmax(PointsA,PointsB)-pmin(PointsA,PointsB)) %>%
  arrange(week)
gamewinnerdf %>% datatable()
```

This next chunk of code helps us view each team instead of each game.

```{r}
oneteameachrow = 
bind_rows(
gamewinnerdf %>%
  select(TeamA,TeamB,PointsA, week, league) %>%
  rename(Team1 = TeamA,Team2 = TeamB,Score = PointsA),
gamewinnerdf %>%
  select(TeamB,TeamA,PointsB, week, league) %>%
  rename(Team1 = TeamB,Team2 = TeamA,Score = PointsB)) 

oneteameachrow %>% datatable()
```

Now, who wins the mug each week?

```{r}
oneteameachrow %>%
  group_by(week) %>%
  top_n(1,Score) %>% 
  select(Team1, Score, week, league) %>%
  arrange(week) %>% as.data.frame()
```

### Lowest Weekly Point Total

In a similar vein, we awarded the coveted (not so much) plunger for the manager who scored the least points each week.

```{r echo=FALSE, fig.width=1}
knitr::include_graphics("/plunger.JPG")
```


```{r}
oneteameachrow %>%
  group_by(week) %>%
  top_n(-1,Score) %>%
  select(Team1, Score, week, league) %>%
  arrange(week) %>% as.data.frame()
```

## Who is good, and who is lucky?

One of the more frustrating things in fantasy football is to score a ton of points, only to play the team who scores the most in your league.  Lets look at some measures of luck.

### Who played the most plungers/mugs

```{r}
oneteameachrow %>%
  group_by(week) %>%
  top_n(-1,Score) %>%
  group_by()
```


### Every team every week