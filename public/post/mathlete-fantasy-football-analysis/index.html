<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8" />

  
  <title>Mathlete Fantasy Football Analysis</title>

  
  




  
  <meta name="author" content="Dusty Turner" />
  <meta name="description" content="IntroductionLets see who really has fantasy football bragging rights and who is just lucky (or unlucky).
During this analysis I will display most of my code. While this doesn’t provided the most pleasent visual experience, it will hopefully help the reader learn from my examples. (And potentially provide feedback on how to improve my methods.)
LibrariesThe libraries I will use for this analysis are the following:" />

  
  
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@dtdusty" />
    <meta name="twitter:title" content="Mathlete Fantasy Football Analysis" />
    <meta name="twitter:description" content="IntroductionLets see who really has fantasy football bragging rights and who is just lucky (or unlucky).
During this analysis I will display most of my code. While this doesn’t provided the most pleasent visual experience, it will hopefully help the reader learn from my examples. (And potentially provide feedback on how to improve my methods.)
LibrariesThe libraries I will use for this analysis are the following:" />
    <meta name="twitter:image" content="/img/avatar.jpg" />
  




<meta name="generator" content="Hugo 0.57.2" />


<link rel="canonical" href="/post/mathlete-fantasy-football-analysis/" />
<link rel="alternative" href="/index.xml" title="Dusty Turner" type="application/atom+xml" />


<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<meta name="format-detection" content="telephone=no,email=no,adress=no" />
<meta http-equiv="Cache-Control" content="no-transform" />


<meta name="robots" content="index,follow" />
<meta name="referrer" content="origin-when-cross-origin" />
<meta name="google-site-verification" content="-jH0wqxQCDh6JrcCbL9tuGso_EV4u1BRT93XjGqNsfo" />
<meta name="msvalidate.01" content="84DDAAE7986A2E9D73062694A69D33A9" />





<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="Dusty Turner" />
<meta name="msapplication-tooltip" content="Dusty Turner" />
<meta name='msapplication-navbutton-color' content="#5fbf5e" />
<meta name="msapplication-TileColor" content="#5fbf5e" />
<meta name="msapplication-TileImage" content="/img/tile-image-windows.png" />
<link rel="icon" href="/img/favicon.ico" />
<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png" />
<link rel="icon" sizes="192x192" href="/img/touch-icon-android.png" />
<link rel="apple-touch-icon" href="/img/touch-icon-apple.png" />
<link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5fbf5e" />



<link rel="stylesheet" href="//cdn.bootcss.com/video.js/6.2.8/alt/video-js-cdn.min.css" />

<link rel="stylesheet" href="/css/bundle.css" />
<link rel="stylesheet" href="/css/lightfair.css" rel="stylesheet" id="theme-stylesheet">
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

  
  <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <script src="//cdn.bootcss.com/video.js/6.2.8/ie8/videojs-ie8.min.js"></script>
  <![endif]-->

<!--[if lte IE 11]>
    <script src="//cdn.bootcss.com/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->


<script src="//cdn.bootcss.com/object-fit-images/3.2.3/ofi.min.js"></script>


<script src="//cdn.bootcss.com/smooth-scroll/12.1.4/js/smooth-scroll.polyfills.min.js"></script>


</head>
  <body>
    
    <div class="suspension">
      <a title="Go to top" class="to-top is-hide"><span class="icon icon-up"></span></a>
      
        
        <a title="Go to comments" class="to-comment" href="#disqus_thread"><span class="icon icon-comment"></span></a>
        
      
    </div>
    
    
  <header class="site-header">
  <img class="avatar" src="/img/dusty.png" alt="Avatar">
  
  <h2 class="title">Dusty Turner</h2>
  
  <p class="subtitle">~Data Science: Lightly Edited~</p>
  <button class="menu-toggle" type="button">
    <span class="icon icon-menu"></span>
  </button>
  <nav class="site-menu collapsed">
    <h2 class="offscreen">Main Menu</h2>
    <ul class="menu-list">
      
      
      
      
        <li class="menu-item  is-active"><a href="/">Home</a></li>
      
        <li class="menu-item "><a href="https://github.com/dusty-turner">Github</a></li>
      
        <li class="menu-item "><a href="/links/">Links</a></li>
      
        <li class="menu-item "><a href="/about/">About</a></li>
      
        <li class="menu-item "><a href="/community/">Community</a></li>
      
        <li class="menu-item "><a href="/cv.pdf">CV</a></li>
      
    </ul>
  </nav>
  <nav class="social-menu collapsed">
    <h2 class="offscreen">Social Networks</h2>
    <ul class="social-list">

      
      <li class="social-item">
        <a href="mailto:dusty.s.turner@gmail.com" title="Email"><span class="icon icon-email"></span></a>
      </li>

      
      <li class="social-item">
        <a href="//github.com/dusty-turner" title="GitHub"><span class="icon icon-github"></span></a>
      </li>

      <li class="social-item">
        <a href="//twitter.com/dtdusty" title="Twitter"><span class="icon icon-twitter"></span></a>
      </li>

      <li class="social-item">
        <a href="//www.facebook.com/dusty.turner" title="Facebook"><span class="icon icon-facebook"></span></a>
      </li>

      

      

      

      

      

      

      

      

      

      

      

      

      

      <li class="social-item">
        <a href="//www.linkedin.com/in/dusty-turner-34a148112" title="Linkedin"><span class="icon icon-linkedin"></span></a>
      </li>

      

      

      

      <li class="social-item">
        <a href="/index.xml"><span class="icon icon-rss" title="RSS"></span></a>
      </li>

    </ul>
  </nav>
</header>

  <section class="main post-detail">
    <header class="post-header">
      <h1 class="post-title">Mathlete Fantasy Football Analysis</h1>
      <p class="post-meta">@Dusty Turner · Nov 19, 2017 · 14 min read</p>
    </header>
    <article class="post-content">
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/datatables-binding/datatables.js"></script>
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="/rmarkdown-libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Lets see who really has fantasy football bragging rights and who is just lucky (or unlucky).</p>
<p>During this analysis I will display most of my code. While this doesn’t provided the most pleasent visual experience, it will hopefully help the reader learn from my examples. (And potentially provide feedback on how to improve my methods.)</p>
<div id="libraries" class="section level3">
<h3>Libraries</h3>
<p>The libraries I will use for this analysis are the following:</p>
<pre class="r"><code>library(tidyverse)
library(stringr)
library(httr)
library(jsonlite)
library(knitr)
library(DT)</code></pre>
</div>
</div>
<div id="data-manipulation" class="section level2">
<h2>Data Manipulation</h2>
<p>It took me a while, but I finally figured out how to access the ESPN Fantasy Football API.</p>
<pre class="r"><code>url = &quot;http://games.espn.com/ffl/api/v2/leagueSettings?leagueId=1314476&amp;seasonId=2017&quot;
raw.result &lt;- GET(url = url)
this.raw.content &lt;- rawToChar(raw.result$content)
this.content &lt;- fromJSON(this.raw.content)</code></pre>
<div id="clean-and-parse" class="section level3">
<h3>Clean and Parse</h3>
<p>The API attains the data in JSON format which can be difficult to work with. While I am proud about some of my parsing, it does leave much that can be improved. The experienced with R/JSON may look down on my methods… but they work.</p>
<p>I’ll start by creating a function:</p>
<p><strong>Note - I made a change recently. Apparently ESPN has changed their API. You can see the new code and the old code (commented out) below. Thanks so much to Jeffrey Sumner below for the solution!</strong></p>
<pre class="r"><code>games&lt;-function(n)
{
#home and away team scores
scoreaway = lapply(n, &quot;[&quot;,c(&quot;awayTeamScores&quot;))
scorehome = lapply(n, &quot;[&quot;,c(&quot;homeTeamScores&quot;))
#who the away team is
test = lapply(n, &quot;[[&quot;,4)
awayteam2 = lapply(test,&quot;[&quot;,c(&quot;teamLocation&quot;))
awayteam1 = lapply(test,&quot;[&quot;,c(&quot;teamNickname&quot;))
#who the home team is
test2 = lapply(n, &quot;[[&quot;,6)
hometeam2 = lapply(test2,&quot;[&quot;,c(&quot;teamLocation&quot;))
hometeam1 = lapply(test2,&quot;[&quot;,c(&quot;teamNickname&quot;))

fhelper = data.frame(Away = paste(unlist(awayteam2), unlist(awayteam1)), Home = paste(unlist(hometeam2), unlist(hometeam1)), awayscore = unlist(scoreaway), homescore = unlist(scorehome), week = 1:16)
return(fhelper)
}
# games&lt;-function(n)
# {
#   #home and away team scores
#   scoreaway = lapply(n, &quot;[&quot;,c(2))
#   scorehome = lapply(n, &quot;[&quot;,c(9))
#   #who the away team is
#   test = lapply(n, &quot;[[&quot;,3)
#   awayteam1 = lapply(test,&quot;[&quot;,4)
#   awayteam2 = lapply(test,&quot;[&quot;,6)
#   #who the home team is
#   test2 = lapply(n, &quot;[[&quot;,12)
#   hometeam1 = lapply(test2,&quot;[&quot;,4)
#   hometeam2 = lapply(test2,&quot;[&quot;,6)
#   
#   fhelper = data.frame(Away = paste(unlist(awayteam2), unlist(awayteam1)), Home = paste(unlist(hometeam2), unlist(hometeam1)), awayscore = unlist(scoreaway), homescore = unlist(scorehome), week = 1:16)
#   return(fhelper)
# }</code></pre>
<p>After writing my funtion, I’ll run it:</p>
<pre class="r"><code>fantasystart = games(
  c(
    this.content$leaguesettings$teams$`1`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`2`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`3`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`4`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`5`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`6`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`7`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`8`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`9`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`10`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`11`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`12`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`13`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`14`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`15`$scheduleItems$matchups,
    this.content$leaguesettings$teams$`16`$scheduleItems$matchups
  )
)</code></pre>
<p>Lets look at the data. It contains every game and result thoughtout the season. This includes games that have not been played yet so we’ll have to account for that later.</p>
<pre class="r"><code>as.tibble(fantasystart)</code></pre>
<pre><code>## # A tibble: 256 x 5
##    Away                   Home                   awayscore homescore  week
##    &lt;chr&gt;                  &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;
##  1 &#39;R&#39;m Chair Quarterback Epsilon Ballers            125.       64.3     1
##  2 Team Guns N&#39; Rosas     &#39;R&#39;m Chair Quarterback     151.      109.      2
##  3 2-2-2 Mega-H-Ertz      &#39;R&#39;m Chair Quarterback     138.       99.5     3
##  4 &#39;R&#39;m Chair Quarterback Las Vegas Radians           85.6     105.      4
##  5 Green Baye&#39;s Theorem   &#39;R&#39;m Chair Quarterback      83.5     121.      5
##  6 &#39;R&#39;m Chair Quarterback Baby got Dak               101.       73.4     6
##  7 &#39;R&#39;m Chair Quarterback a^2+b^2= c^hawks           130.       78.3     7
##  8 &#39;R&#39;m Chair Quarterback Team LaPorte                83.8      89.6     8
##  9 Berry Berry Good       &#39;R&#39;m Chair Quarterback      98        93.4     9
## 10 &#39;R&#39;m Chair Quarterback The Big Gronkowski          97.2     124.     10
## # ... with 246 more rows</code></pre>
</div>
<div id="transform" class="section level3">
<h3>Transform</h3>
<p>So far so good. Now lets transform the data in 4 columns: Team Name, Score, Who Scored The Points, and the Week of the Matchup.</p>
<pre class="r"><code>fantasy = 
fantasystart %&gt;%
select(Away, awayscore, week) %&gt;%
  mutate(Team = Away) %&gt;%
  mutate(Score = awayscore) %&gt;%
  mutate(Who = &quot;For&quot;) %&gt;%
  select(Team, Score, Who, week) %&gt;%
  bind_rows(
    fantasystart %&gt;%
      select(Home, homescore, week) %&gt;%
      mutate(Team = Home) %&gt;%
      mutate(Score = homescore) %&gt;%
      mutate(Who = &quot;For&quot;) %&gt;%
      select(Team, Score, Who, week)
  ) %&gt;%
  bind_rows(
    fantasystart %&gt;%
      select(Away, homescore, week) %&gt;%
      mutate(Team = Away) %&gt;%
      mutate(Score = homescore) %&gt;%
      mutate(Who = &quot;Against&quot;) %&gt;%
      select(Team, Score, Who, week) 
   ) %&gt;%
  bind_rows(
    fantasystart %&gt;%
      select(Home, awayscore, week) %&gt;%
      mutate(Team = Home) %&gt;%
      mutate(Score = awayscore) %&gt;%
      mutate(Who = &quot;Against&quot;) %&gt;%
      select(Team, Score, Who, week)
  )</code></pre>
<p>Peak at the data again.</p>
<pre><code>##                     Team  Score Who week
## 1 &#39;R&#39;m Chair Quarterback 164.50 For   11
## 2 &#39;R&#39;m Chair Quarterback 164.50 For   11
## 3     Team Guns N&#39; Rosas 163.42 For   16
## 4     Team Guns N&#39; Rosas 163.42 For   16
## 5     Team Guns N&#39; Rosas 159.86 For    3
## 6     Team Guns N&#39; Rosas 159.86 For    3</code></pre>
<pre><code>##                 Team  Score     Who week
## 1        Team Grymes 164.50 Against   11
## 2        Team Grymes 164.50 Against   11
## 3 Calgary Stampeders 163.42 Against   16
## 4 Calgary Stampeders 163.42 Against   16
## 5  Las Vegas Radians 159.86 Against    3
## 6  Las Vegas Radians 159.86 Against    3</code></pre>
<p>Now that our data is taking shape, lets add a row to indicate which team performed the worse each week - and also who played the team that performed the worse.</p>
<p>In our league, the worse performane wins a golden plunger, hence the variable names.</p>
<pre class="r"><code>plung = 
fantasy %&gt;%
  group_by(week) %&gt;%
  summarise(Plunger = min(Score))

fantasy = 
  fantasy %&gt;%
  left_join(plung) %&gt;%
  mutate(Plunger = ifelse(Plunger==Score,1,0))

as.tibble(fantasy)</code></pre>
<pre><code>## # A tibble: 1,024 x 5
##    Team                   Score Who    week Plunger
##    &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt; &lt;int&gt;   &lt;dbl&gt;
##  1 &#39;R&#39;m Chair Quarterback 125.  For       1       0
##  2 Team Guns N&#39; Rosas     151.  For       2       0
##  3 2-2-2 Mega-H-Ertz      138.  For       3       0
##  4 &#39;R&#39;m Chair Quarterback  85.6 For       4       0
##  5 Green Baye&#39;s Theorem    83.5 For       5       0
##  6 &#39;R&#39;m Chair Quarterback 101.  For       6       0
##  7 &#39;R&#39;m Chair Quarterback 130.  For       7       0
##  8 &#39;R&#39;m Chair Quarterback  83.8 For       8       0
##  9 Berry Berry Good        98   For       9       0
## 10 &#39;R&#39;m Chair Quarterback  97.2 For      10       0
## # ... with 1,014 more rows</code></pre>
</div>
<div id="mutate" class="section level3">
<h3>Mutate</h3>
<p>Now lets mutate the data to get relevant descriptive statistics.</p>
<pre class="r"><code>fantasy =
fantasy %&gt;%
  filter(Score &gt; 0) %&gt;%
  mutate(Score = as.numeric(as.character(Score))) %&gt;%
  mutate(Team = ifelse(Team == &quot;5 Guns N&#39; Rosas&quot;, &quot;Team Guns N&#39; Rosas&quot;, Team)) %&gt;%
  mutate(Team = ifelse(Team == &quot;3 Baye&#39;s Theorem&quot;, &quot;Green Baye&#39;s Theorem&quot;, Team)) %&gt;%
  mutate(Team = ifelse(Team == &quot;16 Grymes&quot;, &quot;Team Grymes&quot;, Team)) %&gt;%
  group_by(Team, Who) %&gt;%
  summarise(AverageScore = mean(Score), 
            STDEV = sd(Score), 
            max = max(Score), 
            min = min(Score),
            Plunger = sum(Plunger/2)
            ) %&gt;%
  mutate(PlungerLuck = ifelse(Who == &quot;Against&quot;,Plunger,&quot;&quot;), Plunger = ifelse(Who == &quot;For&quot;, Plunger, &quot;&quot;)) %&gt;%
  ungroup() %&gt;%
  arrange(desc(Who), AverageScore) </code></pre>
<p>Lets look at the data again.</p>
<pre><code>## # A tibble: 5 x 8
##   Team                   Who   AverageScore STDEV   max   min Plunger PlungerLuck
##   &lt;chr&gt;                  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      
## 1 Team Guns N&#39; Rosas     For           116.  27.3  163.  72.5 0       &quot;&quot;         
## 2 Team Mauled Mentos     For           116.  18.7  147.  78.2 0       &quot;&quot;         
## 3 The Big Gronkowski     For           115.  20.0  148.  68.6 0       &quot;&quot;         
## 4 &#39;R&#39;m Chair Quarterback For           109.  22.8  164.  83.8 0       &quot;&quot;         
## 5 Calgary Stampeders     For           108.  27.4  158.  68.9 0       &quot;&quot;</code></pre>
<pre><code>## # A tibble: 5 x 8
##   Team                   Who     AverageScore STDEV   max   min Plunger PlungerLuck
##   &lt;chr&gt;                  &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      
## 1 Team Guns N&#39; Rosas     Against         113.  20.9  145.  66.1 &quot;&quot;      1          
## 2 a^2+b^2= c^hawks       Against         109.  21.9  150.  73.2 &quot;&quot;      0          
## 3 Team Grymes            Against         108.  27.7  164.  68.6 &quot;&quot;      0          
## 4 &#39;R&#39;m Chair Quarterback Against         107.  30.1  155.  64.3 &quot;&quot;      0          
## 5 Green Baye&#39;s Theorem   Against         104.  20.4  143.  61.3 &quot;&quot;      1</code></pre>
</div>
<div id="plotting-preparation" class="section level3">
<h3>Plotting Preparation</h3>
<p>Getting even better. Now we have the descriptive statistics, we need to add a couple of columns to help with plotting the data.</p>
<p>To do this, I will:</p>
<ol style="list-style-type: decimal">
<li>Add a dummy variable <code>dummy</code> to help my plotting aesthetics.</li>
<li>Add a dummy variable <code>ord</code> to help set the order of my facets.</li>
<li>Set the order of my Teams so <code>ggplot</code> will facet them in the right order.</li>
</ol>
<pre class="r"><code>fantasy = 
fantasy %&gt;%
  mutate(dummy = 0) %&gt;%
  mutate(ord = row_number())
  
fantasy$Team = factor(fantasy$Team, levels=unique(fantasy$Team[order(fantasy$ord)]), ordered=TRUE)</code></pre>
<p>One last look at the data:</p>
<pre><code>## # A tibble: 5 x 10
##   Team                   Who   AverageScore STDEV   max   min Plunger PlungerLuck dummy   ord
##   &lt;ord&gt;                  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
## 1 Team Guns N&#39; Rosas     For           116.  27.3  163.  72.5 0       &quot;&quot;              0    16
## 2 Team Mauled Mentos     For           116.  18.7  147.  78.2 0       &quot;&quot;              0    15
## 3 The Big Gronkowski     For           115.  20.0  148.  68.6 0       &quot;&quot;              0    14
## 4 &#39;R&#39;m Chair Quarterback For           109.  22.8  164.  83.8 0       &quot;&quot;              0    13
## 5 Calgary Stampeders     For           108.  27.4  158.  68.9 0       &quot;&quot;              0    12</code></pre>
<pre><code>## # A tibble: 5 x 10
##   Team                   Who     AverageScore STDEV   max   min Plunger PlungerLuck dummy   ord
##   &lt;ord&gt;                  &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
## 1 Team Guns N&#39; Rosas     Against         113.  20.9  145.  66.1 &quot;&quot;      1               0    32
## 2 a^2+b^2= c^hawks       Against         109.  21.9  150.  73.2 &quot;&quot;      0               0    31
## 3 Team Grymes            Against         108.  27.7  164.  68.6 &quot;&quot;      0               0    30
## 4 &#39;R&#39;m Chair Quarterback Against         107.  30.1  155.  64.3 &quot;&quot;      0               0    29
## 5 Green Baye&#39;s Theorem   Against         104.  20.4  143.  61.3 &quot;&quot;      1               0    28</code></pre>
</div>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
<div id="plot" class="section level3">
<h3>Plot</h3>
<p>Nice, now lets plot the data. It will be valuable to see how each team scores (dark values) verses how much they get scored against (light values). We’ll plot the max and min scores as well as a confidence interval at the true mean of their score.</p>
<pre class="r"><code>a=.5
ggplot(data = fantasy, aes(y = AverageScore, x = dummy,ymin = AverageScore-2*STDEV, ymax = AverageScore+2*STDEV)) +
# ggplot(data = fantasy, aes(y = AverageScore, x = dummy,ymin = min, ymax = max)) +
  geom_point(aes(alpha = Who, shape = Who, size = a)) +
  geom_point(aes(y = max, x = dummy, color = &quot;red&quot;, alpha = Who, shape = Who, size = a)) +
  geom_point(aes(y = min, x = dummy, color = &quot;blue&quot;, alpha = Who, shape = Who, size = a)) +
  guides(colour=FALSE, size = FALSE) +
  geom_errorbar(aes(alpha = Who)) +
  scale_alpha_discrete(range=c(0.3, 1)) +
  scale_radius() +
  geom_text(aes(y = 35, x = 0, label = Plunger, fontface = &quot;bold&quot;)) +
  geom_text(aes(y = 175, x = 0, label = PlungerLuck, fontface = &quot;bold&quot;)) +
  facet_grid(Team~.) +
  # geom_text(hjust = 0, aes(label = Plunger)) +
  theme(strip.text.y = element_text(angle = 0),
        # axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        # axis.text.y=Plunger,
        axis.ticks.y =element_blank()) +
  xlab(&quot;Left - Plungers Earned : Right - Plungers Played Against&quot;) + ylab(&quot;Average Weekly Score&quot;) +
  coord_flip() +
  ggtitle(&quot;Is Your Team As Bad (or Good) As You Think It Is?&quot;) +
  labs(caption = &quot;Through Week 10&quot;) </code></pre>
<pre><code>## Warning: Using alpha for a discrete variable is not advised.</code></pre>
<p><img src="/post/2017-11-19-mathlete-fantasy-football-analysis_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="analysis" class="section level3">
<h3>Analysis</h3>
<p>If you’ll take a look at the chart, you can interpret the chart in the following way:</p>
<ol style="list-style-type: decimal">
<li>Teams are sorted by average points scored per game.</li>
<li>The unshaded colors note points your team has scored.</li>
<li>The shaded colors note points that have been scored against you.</li>
<li>The confidence interval contains the true mean points that your team scores.<br />
</li>
<li>The blue dots are the max points you scored in a week (or was scored against you if shaded).</li>
<li>The red dots are the min points you scored in a week (or was scored against you if shaded).</li>
</ol>
<p>Key takeaways:</p>
<ol style="list-style-type: decimal">
<li>Even the “best” teams do not score significantly more than the “worst” teams.</li>
<li>Potentially, the good teams don’t necessarily score more, they just have less points scored against them.</li>
<li>Teams with inconsistent scoring: Baby Got Dak, Guns N’ Rosas</li>
<li>Teams with consistent scoring: Team Mauled Mentos, ‘R’m Chair Quarterback, a^2 + b^2 = c^Hawks</li>
<li>Teams who are ranked higher have generally played teams who have won the plunger.</li>
</ol>
</div>
</div>
<div id="measures-of-luck" class="section level2">
<h2>Measures of Luck</h2>
<p>Lets extract some more data from our JSON output to help us measure the ‘luck’ teams are experiencing. In the painful code below, we extract team names and their current playoff seeding.</p>
<pre class="r"><code>standing = data.frame(
  Team = c(paste(this.content$leaguesettings$teams$`1`$teamLocation, this.content$leaguesettings$teams$`1`$teamNickname),
           paste(this.content$leaguesettings$teams$`2`$teamLocation, this.content$leaguesettings$teams$`2`$teamNickname),
           paste(this.content$leaguesettings$teams$`3`$teamLocation, this.content$leaguesettings$teams$`3`$teamNickname),
           paste(this.content$leaguesettings$teams$`4`$teamLocation, this.content$leaguesettings$teams$`4`$teamNickname),
           paste(this.content$leaguesettings$teams$`5`$teamLocation, this.content$leaguesettings$teams$`5`$teamNickname),
           paste(this.content$leaguesettings$teams$`6`$teamLocation, this.content$leaguesettings$teams$`6`$teamNickname),
           paste(this.content$leaguesettings$teams$`7`$teamLocation, this.content$leaguesettings$teams$`7`$teamNickname),
           paste(this.content$leaguesettings$teams$`8`$teamLocation, this.content$leaguesettings$teams$`8`$teamNickname),
           paste(this.content$leaguesettings$teams$`9`$teamLocation, this.content$leaguesettings$teams$`9`$teamNickname),
           paste(this.content$leaguesettings$teams$`10`$teamLocation, this.content$leaguesettings$teams$`10`$teamNickname),
           paste(this.content$leaguesettings$teams$`11`$teamLocation, this.content$leaguesettings$teams$`11`$teamNickname),
           paste(this.content$leaguesettings$teams$`12`$teamLocation, this.content$leaguesettings$teams$`12`$teamNickname),
           paste(this.content$leaguesettings$teams$`13`$teamLocation, this.content$leaguesettings$teams$`13`$teamNickname),
           paste(this.content$leaguesettings$teams$`14`$teamLocation, this.content$leaguesettings$teams$`14`$teamNickname),
           paste(this.content$leaguesettings$teams$`15`$teamLocation, this.content$leaguesettings$teams$`15`$teamNickname),
           paste(this.content$leaguesettings$teams$`16`$teamLocation, this.content$leaguesettings$teams$`16`$teamNickname)),
  
  rank = c(this.content$leaguesettings$teams$`1`$record$overallStanding,
           this.content$leaguesettings$teams$`2`$record$overallStanding,
           this.content$leaguesettings$teams$`3`$record$overallStanding,
           this.content$leaguesettings$teams$`4`$record$overallStanding,
           this.content$leaguesettings$teams$`5`$record$overallStanding,
           this.content$leaguesettings$teams$`6`$record$overallStanding,
           this.content$leaguesettings$teams$`7`$record$overallStanding,
           this.content$leaguesettings$teams$`8`$record$overallStanding,
           this.content$leaguesettings$teams$`9`$record$overallStanding,
           this.content$leaguesettings$teams$`10`$record$overallStanding,
           this.content$leaguesettings$teams$`11`$record$overallStanding,
           this.content$leaguesettings$teams$`12`$record$overallStanding,
           this.content$leaguesettings$teams$`13`$record$overallStanding,
           this.content$leaguesettings$teams$`14`$record$overallStanding,
           this.content$leaguesettings$teams$`15`$record$overallStanding,
           this.content$leaguesettings$teams$`16`$record$overallStanding)
  )</code></pre>
<p>And to look at it:</p>
<pre class="r"><code>as.tibble(standing)</code></pre>
<pre><code>## # A tibble: 16 x 2
##    Team                    rank
##    &lt;chr&gt;                  &lt;int&gt;
##  1 &#39;R&#39;m Chair Quarterback    10
##  2 Las Vegas Radians          8
##  3 Green Baye&#39;s Theorem      11
##  4 Epsilon Ballers           15
##  5 Team Guns N&#39; Rosas         6
##  6 2-2-2 Mega-H-Ertz         13
##  7 a^2+b^2= c^hawks          14
##  8 Baby got Dak               2
##  9 Team HotHanksHitters       9
## 10 Team LaPorte               4
## 11 Viking Joe Lindquist       7
## 12 The Big Gronkowski         5
## 13 Berry Berry Good          16
## 14 Calgary Stampeders         1
## 15 Team Mauled Mentos         3
## 16 Team Grymes               12</code></pre>
<p>Lets join the data with our previous dataset.</p>
<pre class="r"><code>fantasy2 = fantasy %&gt;%
  filter(Who == &quot;For&quot;) %&gt;%
  left_join(standing, by = &quot;Team&quot;)
as.tibble(fantasy)</code></pre>
<pre><code>## # A tibble: 32 x 10
##    Team                 Who   AverageScore STDEV   max   min Plunger PlungerLuck dummy   ord
##    &lt;ord&gt;                &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
##  1 Team Grymes          For           84.4  27.7  150.  43.1 5       &quot;&quot;              0     1
##  2 Green Baye&#39;s Theorem For           91.8  21.4  129.  64.0 1       &quot;&quot;              0     2
##  3 Epsilon Ballers      For           95.3  20.1  128.  56   1       &quot;&quot;              0     3
##  4 Berry Berry Good     For           95.9  22.7  137.  64.2 4       &quot;&quot;              0     4
##  5 Team HotHanksHitters For           99.0  20.5  143.  63.4 0       &quot;&quot;              0     5
##  6 Team LaPorte         For          100.   22.7  136.  61.3 2       &quot;&quot;              0     6
##  7 2-2-2 Mega-H-Ertz    For          102.   17.6  138.  73.2 0       &quot;&quot;              0     7
##  8 Baby got Dak         For          103.   25.1  148.  60.8 1       &quot;&quot;              0     8
##  9 a^2+b^2= c^hawks     For          105.   15.9  144.  78.3 0       &quot;&quot;              0     9
## 10 Las Vegas Radians    For          105.   20.2  141.  66.1 1       &quot;&quot;              0    10
## # ... with 22 more rows</code></pre>
<p>Almost complete: Next lets add a column to keep track of each team’s ‘actual rank’ (according to points scored) as well as a measure of luck. This measure, though a simple calculation, is the the euclidian distance from how much (or how much less) a team is performing verses what they should expect given their current performance.</p>
<pre class="r"><code>fantasy2 =
fantasy2 %&gt;%
  mutate(actualrank = c(16:1)) %&gt;%
  mutate(Luck = actualrank-rank)</code></pre>
<p>Finally! Lets plot the data and see how everyone is doing.</p>
<pre class="r"><code>ggplot(data = fantasy2, aes(x = actualrank, y = rank)) +
  geom_point() +
  geom_text(aes(label = paste(Team,&quot;:&quot; ,Luck), color = Luck), vjust =1.5, size=3) +
  scale_colour_gradient(low = &quot;red&quot;, high = &quot;black&quot;) +
  geom_text(aes(x = 8, y = 8, label = &quot;Line of Luck&quot;), angle = 35, nudge_y = .6) +
  geom_abline(slope = 1, intercept = 0) +
  ylim(c(1,17)) + xlim(c(1,17)) +
  xlab(&quot;Points Scored Rank&quot;) + ylab(&quot;Actual Standings&quot;) + ggtitle(&quot;Are You Over-Performing or Under-Performing?&quot;) +
  labs(caption = &quot;The Luck Index measures how much better (or worse) your team is doing than what you should expect.&quot;)</code></pre>
<p><img src="/post/2017-11-19-mathlete-fantasy-football-analysis_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>This is a way to sort the data to get another view of who is ranked up to their performance.</p>
<pre class="r"><code>fantasyfor = fantasy %&gt;%
  filter(Who == &quot;For&quot;) %&gt;%
  mutate(MaxPointsScored = max, MinPointsScored = min, PlungersPlayedAgainst = PlungerLuck) %&gt;%
  select(Team, AverageScore, MaxPointsScored, MinPointsScored, Plunger)
fantasyagainst = fantasy %&gt;%
  filter(Who == &quot;Against&quot;)%&gt;%
  mutate(MaxPointsAgainst = max, MinPointsAgainst = min, PlungersPlayedAgainst = PlungerLuck) %&gt;%
  select(Team, MaxPointsAgainst, MinPointsAgainst, PlungersPlayedAgainst) 
FantasyChartstart = fantasyfor %&gt;%
  left_join(fantasyagainst, by = &quot;Team&quot;)

FantasyChart = FantasyChartstart %&gt;%
  mutate(Scored = round(AverageScore),2) %&gt;%
  mutate(Max = MaxPointsScored) %&gt;%
  mutate(Min = MinPointsScored) %&gt;%
  mutate(MaxFoe = MaxPointsAgainst) %&gt;%
  mutate(MinFoe = MinPointsAgainst) %&gt;%
  mutate(PlungerFoe = PlungersPlayedAgainst)%&gt;%
  select(Team,Scored, Max,Min,Plunger,MaxFoe,MinFoe,PlungerFoe)

# options(DT.options = list(pageLength = 16))
datatable(FantasyChart, options = list(
  columnDefs = list(list(className = &#39;dt-center&#39;, targets = 8)),
  pageLength = 16
))</code></pre>
<div id="htmlwidget-1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],["Team Grymes","Green Baye's Theorem","Epsilon Ballers","Berry Berry Good","Team HotHanksHitters","Team LaPorte","2-2-2 Mega-H-Ertz","Baby got Dak","a^2+b^2= c^hawks","Las Vegas Radians","Viking Joe Lindquist","Calgary Stampeders","'R'm Chair Quarterback","The Big Gronkowski","Team Mauled Mentos","Team Guns N' Rosas"],[84,92,95,96,99,100,102,103,105,105,106,108,109,115,116,116],[149.68,128.76,128.38,136.96,143.46,136.46,138.18,147.56,144.24,141.22,149.6,158.4,164.5,147.54,147.46,163.42],[43.14,63.98,56,64.2,63.42,61.32,73.18,60.78,78.3,66.12,63.94,68.92,83.82,68.62,78.24,72.46],["5","1","1","4","0","2","0","1","0","1","1","0","0","0","0","0"],[164.5,143.46,134.22,129.3,141.22,150.64,139.72,158.4,149.68,159.86,147.46,163.42,154.98,136.5,129.78,144.6],[68.62,61.32,61.6,77.12,63.56,56,65.86,63.42,73.18,43.14,74.28,64.2,64.32,60.78,70.16,66.12],["0","1","3","0","3","1","0","0","0","1","0","2","0","2","2","1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Team<\/th>\n      <th>Scored<\/th>\n      <th>Max<\/th>\n      <th>Min<\/th>\n      <th>Plunger<\/th>\n      <th>MaxFoe<\/th>\n      <th>MinFoe<\/th>\n      <th>PlungerFoe<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":8},{"className":"dt-right","targets":[2,3,4,6,7]},{"orderable":false,"targets":0}],"pageLength":16,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,16,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<p>Lastly, lets look at who just eeks out wins and who snatches defeat from the jaws of victory.</p>
<pre class="r"><code>start = fantasystart %&gt;%
  mutate(delta = awayscore-homescore) %&gt;%
  mutate(win = ifelse(delta&gt;0, &quot;Win&quot;, &quot;Loss&quot;)) %&gt;%
  group_by(Away) %&gt;%
  mutate(margin = ifelse(win == &quot;Win&quot;, min(delta[delta&gt;0]),max(delta[delta&lt;0]))) %&gt;%
  group_by(Away, win) %&gt;%
  summarise(Smallest = mean(margin)) %&gt;%
  ungroup() %&gt;%
  mutate(Away = ifelse(Away == &quot;5 Guns N&#39; Rosas&quot;, &quot;Team Guns N&#39; Rosas&quot;, Away)) %&gt;%
  mutate(Away = ifelse(Away == &quot;3 Baye&#39;s Theorem&quot;, &quot;Green Baye&#39;s Theorem&quot;, Away)) %&gt;%
  mutate(Away = ifelse(Away == &quot;16 Grymes&quot;, &quot;Team Grymes&quot;, Away)) 

a = start %&gt;%
  filter(win == &quot;Win&quot;) 
b = start %&gt;%
  filter(win == &quot;Loss&quot;) 

MarginofVictory = left_join(a,b, by = &quot;Away&quot;) %&gt;%
  mutate(SmallestWin = round(Smallest.x,2), SmallestLoss = round(Smallest.y,2), Team = Away) %&gt;%
  select(Team, SmallestWin, SmallestLoss)</code></pre>
<p>And the Chart…</p>
<pre class="r"><code>datatable(MarginofVictory, options = list(
  columnDefs = list(list(className = &#39;dt-center&#39;, targets = 3)),
  pageLength = 16
))</code></pre>
<div id="htmlwidget-2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],["'R'm Chair Quarterback","2-2-2 Mega-H-Ertz","a^2+b^2= c^hawks","Baby got Dak","Berry Berry Good","Calgary Stampeders","Epsilon Ballers","Green Baye's Theorem","Las Vegas Radians","Team Grymes","Team Guns N' Rosas","Team HotHanksHitters","Team LaPorte","Team Mauled Mentos","The Big Gronkowski","Viking Joe Lindquist"],[27.14,35.64,0.26,13.32,3.06,0.46,0.66,25.44,5.54,8.38,4.88,9.82,5.86,4.82,0.6,17.22],[-5.76,-0.96,-4.58,-18,-3.7,-20.24,-6.7,-4.22,-4.48,-4.4,-17.44,-15.88,-11.98,-22.28,-13.88,-0.16]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Team<\/th>\n      <th>SmallestWin<\/th>\n      <th>SmallestLoss<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":3},{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"pageLength":16,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,16,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</article>
    <footer class="post-footer">
      
      <ul class="post-tags">
        
          <li><a href="/tags/fantasy-football"><span class="tag">Fantasy Football</span></a></li>
        
          <li><a href="/tags/r"><span class="tag">R</span></a></li>
        
          <li><a href="/tags/rmd"><span class="tag">Rmd</span></a></li>
        
          <li><a href="/tags/beatnavy"><span class="tag">Beatnavy</span></a></li>
        
          <li><a href="/tags/army-math"><span class="tag">Army Math</span></a></li>
        
          <li><a href="/tags/espn-api"><span class="tag">ESPN API</span></a></li>
        
      </ul>
      
      <p class="post-copyright">
        © This post is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License，please give source if you likes to quote or reproduce.This post was published <strong>675</strong> days ago, content in the post may be inaccurate, even wrong now, please take risk yourself.
      </p>
    </footer>
    
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "dusty-turner" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
    
  </section>
  <footer class="site-footer">
  <p>© 2017-2019 Dusty Turner</p>
  <p>Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> with theme <a href="https://github.com/laozhu/hugo-nuo" target="_blank">Nuo</a>.</p>
  
</footer>



<script async src="//cdn.bootcss.com/video.js/6.2.8/alt/video.novtt.min.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\[','\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    }
  });
</script>
<script type="text/x-mathjax-config">
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script>

<script src="/js/bundle.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-109926409-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>





  </body>
</html>
